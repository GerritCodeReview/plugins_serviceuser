{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b23ff34f_82cfb13b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 8
      },
      "lineNbr": 7,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-01-07T15:16:15Z",
      "side": 1,
      "message": "stable-3.3 branch is different from 3.3.0 tag. This commit would only work with the upcoming 3.3.2 release (not released yet), because of the change 292745.",
      "range": {
        "startLine": 7,
        "startChar": 28,
        "endLine": 7,
        "endChar": 33
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d6ba156_82e60511",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-01-07T15:13:04Z",
      "side": 1,
      "message": "It doesn\u0027t build in standalone build mode with this plugin API version:\n\n  $ bazel build serviceuser\n  ServiceUserResolver.java:137: error: method does not override or implement a method from a supertype\n              @Override\n              ^\n  Target //:serviceuser failed to build\n  Use --verbose_failures to see the command lines of failed build steps.\n\nThe should be changed to: 3.3.2-SNAPSHOT and publish the API on the latest commit in gerrit tree, on stable-3.3 brach:\n\n  $ tools/maven/api.sh install\n\nThat should fix the standalone build mode if the version is changed to \"3.3.2-SNAPSHOT\".",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ce47d475_5dea27a0",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2021-01-07T15:33:32Z",
      "side": 1,
      "message": "\u003e It doesn\u0027t build in standalone build mode with this plugin API version:\n\nCurrently the plugin\u0027s documentation [1] doesn\u0027t even mention standalone build.\nI have nothing against providing the standalone build but should the lack of it\nblock this change?\n\n[1] https://gerrit.googlesource.com/plugins/serviceuser/+/bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7/src/main/resources/Documentation/build.md",
      "parentUuid": "6d6ba156_82e60511",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a1e98e8_376cf191",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-01-07T15:48:53Z",
      "side": 1,
      "message": "\u003e \u003e It doesn\u0027t build in standalone build mode with this plugin API version:\n\u003e \n\u003e Currently the plugin\u0027s documentation [1] doesn\u0027t even mention standalone build.\n\nThat\u0027s because not all plugins have standalone builds: for some of them it isn\u0027t even possible to have one (e.g. websession-flatfile) because a single branch of the plugin needs to be built with different versions of Gerrit.\n\n\u003e I have nothing against providing the standalone build but should the lack of it\n\u003e block this change?\n\nThat\u0027s up to you, as you are the maintainer :-)\nFrom a CI\u0027s perspective, it doesn\u0027t block the change because the CI uses the in-tree build only.\n\nLuca.\n\n\u003e [1] https://gerrit.googlesource.com/plugins/serviceuser/+/bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7/src/main/resources/Documentation/build.md",
      "parentUuid": "ce47d475_5dea27a0",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "54605e38_2bffd05e",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2021-01-07T15:53:53Z",
      "side": 1,
      "message": "\u003e That\u0027s up to you, as you are the maintainer :-)\n\nThen DavidO needs to remove his Verified-1 :-)\n\n\u003e From a CI\u0027s perspective, it doesn\u0027t block the change because the CI uses the in-tree build only.\n\nInterestingly, I started getting some errorprone errors when building in-tree with stable-3.3 branch of Gerrit core. I wonder why the CI build doesn\u0027t produce the same errors?\nAn example is in the RefUpdateListener.java where the returned Future from this call is ignored:\n\n  workQueue.getDefaultQueue().submit(task);",
      "parentUuid": "9a1e98e8_376cf191",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eb7c7060_32ac3915",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-01-07T15:57:21Z",
      "side": 1,
      "message": "\u003e \u003e That\u0027s up to you, as you are the maintainer :-)\n\u003e \n\u003e Then DavidO needs to remove his Verified-1 :-)\n\u003e \n\u003e \u003e From a CI\u0027s perspective, it doesn\u0027t block the change because the CI uses the in-tree build only.\n\u003e \n\u003e Interestingly, I started getting some errorprone errors when building in-tree with stable-3.3 branch of Gerrit core. I wonder why the CI build doesn\u0027t produce the same errors?\n\nThe CI does the in-tree build, which uses the errorprone configuration of Gerrit itself. The standalone build may have a different errorprone configuration settings coming from the Bazlets imported.\n\n@Davido is that a correct explanation?",
      "parentUuid": "54605e38_2bffd05e",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d54c24c4_4ce54443",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2021-01-07T15:59:56Z",
      "side": 1,
      "message": "I am referring to in-tree build inside the stable-3.3 tree of the Gerrit core.",
      "parentUuid": "eb7c7060_32ac3915",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2f4cf6a_9d61b1af",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-01-07T16:05:06Z",
      "side": 1,
      "message": "\u003e I am referring to in-tree build inside the stable-3.3 tree of the Gerrit core.\n\nAh, that\u0027s very unexpected then :-O I see your point.",
      "parentUuid": "d54c24c4_4ce54443",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "de854086_48eb4cc3",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-01-07T16:08:01Z",
      "side": 1,
      "message": "\u003e \u003e I am referring to in-tree build inside the stable-3.3 tree of the Gerrit core.\n\u003e \n\u003e Ah, that\u0027s very unexpected then :-O I see your point.\n\nThe Zuul build output is at:\nhttps://ci.gerritcodereview.com/t/gerrit/build/18d2770cb0764fbd841f26d4cb6f2b42/console",
      "parentUuid": "c2f4cf6a_9d61b1af",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f0fe06a2_c18a6913",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2021-01-07T16:10:44Z",
      "side": 1,
      "message": "I found what causes the difference but I don\u0027t know if this is a bug or a feature of the build toolchain.\n\nInitially, after cloning the serviceuser plugin inside the plugins/ directory the build works. However, when I added the plugin to the release build the error started occurring. But it was my mistake that I also added it in the tools/BUILD:error_prone_packages. After removing it from there the issue is gone.\n\n\n  diff --git a/tools/BUILD b/tools/BUILD\n  index 545a20607b..4ff340093e 100644\n  --- a/tools/BUILD\n  +++ b/tools/BUILD\n  @@ -157,6 +157,7 @@ package_group(\n           \"//plugins/plugin-manager/...\",\n           \"//plugins/replication/...\",\n           \"//plugins/reviewnotes/...\",\n  +        \"//plugins/serviceuser/...\",\n           \"//plugins/singleusergroup/...\",\n           \"//plugins/webhooks/...\",\n       ],\n  diff --git a/tools/bzl/plugins.bzl b/tools/bzl/plugins.bzl\n  index adde59efb7..37eb11b8b0 100644\n  --- a/tools/bzl/plugins.bzl\n  +++ b/tools/bzl/plugins.bzl\n  @@ -8,6 +8,7 @@ CORE_PLUGINS \u003d [\n       \"plugin-manager\",\n       \"replication\",\n       \"reviewnotes\",\n  +    \"serviceuser\",\n       \"singleusergroup\",\n       \"webhooks\",\n   ]",
      "parentUuid": "d54c24c4_4ce54443",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ef0d6efa_a4c646ba",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-01-07T16:16:28Z",
      "side": 1,
      "message": "\u003e Interestingly, I started getting some errorprone errors when building in-tree with stable-3.3 branch of Gerrit core. \n\nTo activate error_prone error toolchain you would have to add this patch in gerrit core:\n\n  diff --git a/tools/BUILD b/tools/BUILD\n  index 545a20607b..4ff340093e 100644\n  --- a/tools/BUILD\n  +++ b/tools/BUILD\n  @@ -157,6 +157,7 @@ package_group(\n         \"//plugins/plugin-manager/...\",\n         \"//plugins/replication/...\",\n         \"//plugins/reviewnotes/...\",\n+        \"//plugins/serviceuser/...\",\n         \"//plugins/singleusergroup/...\",\n         \"//plugins/webhooks/...\",\n     ],\n\nOnly then the error prone errors are reported. Obviously, Zuul CI doesn\u0027t have this change and this EP errors are not reported.",
      "parentUuid": "c2f4cf6a_9d61b1af",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "261d9778_ab4221d7",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-01-07T16:18:59Z",
      "side": 1,
      "message": "\u003e I have nothing against providing the standalone build but should the lack of it\nblock this change?\n\nI\u0027m not talking about providing or removing of standalone build mode. This change makes assumption in the commit message and in WORKSPACE file about 3.3.0 tag, but in reality it\u0027s targeting stable-3.3 branch and upcoming 3.3.2 release. I will upload new patch with one liner fix in a moment.",
      "parentUuid": "ef0d6efa_a4c646ba",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2a857e14_61da6cf7",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2021-01-07T16:22:44Z",
      "side": 1,
      "message": "Sorry, I see what you mean. I didn\u0027t read the commit message carefully and didn\u0027t even pay attention to the WORKSPACE file change.\n\nTurns out that the standalone build was indeed added to this plugin with [1] but it wasn\u0027t documented.\n\n[1] https://gerrit.googlesource.com/plugins/serviceuser/+/440fdd861306c677b490e70f22f254346eb15175",
      "parentUuid": "261d9778_ab4221d7",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "77a684dc_6c48f659",
        "filename": "WORKSPACE",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-01-07T16:22:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "261d9778_ab4221d7",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 29
      },
      "revId": "bffd62fe3ee13fcff8d53f7d5dbb897c32c562b7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}